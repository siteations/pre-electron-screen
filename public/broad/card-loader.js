var files = ["case_wing_zc_93_185_fl_001_001.jpg","case_wing_zc_93_185_fl_001_002.jpg","case_wing_zc_93_185_fl_001_003.jpg","case_wing_zc_93_185_fl_001_004.jpg","case_wing_zc_93_185_fl_002_001.jpg","case_wing_zc_93_185_fl_002_002.jpg","case_wing_zc_93_185_fl_002_003.jpg","case_wing_zc_93_185_fl_002_004.jpg","case_wing_zc_93_185_fl_003_001.jpg","case_wing_zc_93_185_fl_003_002.jpg","case_wing_zc_93_185_fl_003_003.jpg","case_wing_zc_93_185_fl_004_001.jpg","case_wing_zc_93_185_fl_004_002.jpg","case_wing_zc_93_185_fl_004_003.jpg","case_wing_zc_93_185_fl_004_004.jpg","case_wing_zc_93_185_fl_005_001.jpg","case_wing_zc_93_185_fl_005_002.jpg","case_wing_zc_93_185_fl_006_001.jpg","case_wing_zc_93_185_fl_006_002.jpg","case_wing_zc_93_185_fl_006_003.jpg","case_wing_zc_93_185_fl_007_001.jpg","case_wing_zc_93_185_fl_007_002.jpg","case_wing_zc_93_185_fl_007_003.jpg","case_wing_zc_93_185_fl_008_001.jpg","case_wing_zc_93_185_fl_008_002.jpg","case_wing_zc_93_185_fl_008_003.jpg","case_wing_zc_93_185_fl_009_001.jpg","case_wing_zc_93_185_fl_009_002.jpg","case_wing_zc_93_185_fl_009_003.jpg","case_wing_zc_93_185_fl_010_001.jpg","case_wing_zc_93_185_fl_010_002.jpg","case_wing_zc_93_185_fl_011_001.jpg","case_wing_zc_93_185_fl_011_002.jpg","case_wing_zc_93_185_fl_011_003.jpg","case_wing_zc_93_185_fl_011_004.jpg","case_wing_zc_93_185_fl_012_001.jpg","case_wing_zc_93_185_fl_012_002.jpg","case_wing_zc_93_185_fl_012_003.jpg","case_wing_zc_93_185_fl_012_004.jpg","case_wing_zc_93_185_fl_013_001.jpg","case_wing_zc_93_185_fl_013_002.jpg","case_wing_zc_93_185_fl_013_003.jpg","case_wing_zc_93_185_fl_014_001.jpg","case_wing_zc_93_185_fl_014_002.jpg","case_wing_zc_93_185_fl_014_003.jpg","case_wing_zc_93_185_fl_015_001.jpg","case_wing_zc_93_185_fl_015_002.jpg","case_wing_zc_93_185_fl_015_003.jpg","case_wing_zc_93_185_fl_016_001.jpg","case_wing_zc_93_185_fl_016_002.jpg","case_wing_zc_93_185_fl_016_003.jpg","case_wing_zc_93_185_fl_017_001.jpg","case_wing_zc_93_185_fl_017_002.jpg","case_wing_zc_93_185_fl_017_003.jpg","case_wing_zc_93_185_fl_017_004.jpg","case_wing_zc_93_185_fl_018_001.jpg","case_wing_zc_93_185_fl_018_002.jpg","case_wing_zc_93_185_fl_018_003.jpg","case_wing_zc_93_185_fl_019_001.jpg","case_wing_zc_93_185_fl_019_002.jpg","case_wing_zc_93_185_fl_019_003.jpg","case_wing_zc_93_185_fl_020_001.jpg","case_wing_zc_93_185_fl_020_002.jpg","case_wing_zc_93_185_fl_021_001.jpg","case_wing_zc_93_185_fl_021_002.jpg","case_wing_zc_93_185_fl_021_003.jpg","case_wing_zc_93_185_fl_021_004.jpg","case_wing_zc_93_185_fl_022_001.jpg","case_wing_zc_93_185_fl_022_002.jpg","case_wing_zc_93_185_fl_022_003.jpg","case_wing_zc_93_185_fl_022_004.jpg","case_wing_zc_93_185_fl_023_001.jpg","case_wing_zc_93_185_fl_023_002.jpg","case_wing_zc_93_185_fl_023_003.jpg","case_wing_zc_93_185_fl_023_004.jpg","case_wing_zc_93_185_fl_024_001.jpg","case_wing_zc_93_185_fl_024_002.jpg","case_wing_zc_93_185_fl_024_003.jpg","case_wing_zc_93_185_fl_024_004.jpg","case_wing_zc_93_185_fl_025_001.jpg","case_wing_zc_93_185_fl_025_002.jpg","case_wing_zc_93_185_fl_025_003.jpg","case_wing_zc_93_185_fl_026_001.jpg","case_wing_zc_93_185_fl_026_002.jpg","case_wing_zc_93_185_fl_026_003.jpg","case_wing_zc_93_185_fl_026_004.jpg","case_wing_zc_93_185_fl_026_005.jpg","case_wing_zc_93_185_fl_026_006.jpg","case_wing_zc_93_185_fl_027_001.jpg","case_wing_zc_93_185_fl_027_002.jpg","case_wing_zc_93_185_fl_027_003.jpg","case_wing_zc_93_185_fl_028_001.jpg","case_wing_zc_93_185_fl_028_002.jpg","case_wing_zc_93_185_fl_029_001.jpg","case_wing_zc_93_185_fl_029_002.jpg","case_wing_zc_93_185_fl_029_003.jpg","case_wing_zc_93_185_fl_030_001.jpg","case_wing_zc_93_185_fl_030_002.jpg","case_wing_zc_93_185_fl_030_003.jpg","case_wing_zc_93_185_fl_031_001.jpg","case_wing_zc_93_185_fl_031_002.jpg","case_wing_zc_93_185_fl_031_003.jpg","case_wing_zc_93_185_fl_032_001.jpg","case_wing_zc_93_185_fl_032_002.jpg","case_wing_zc_93_185_fl_032_003.jpg","case_wing_zc_93_185_fl_033_001.jpg","case_wing_zc_93_185_fl_033_002.jpg","case_wing_zc_93_185_fl_033_003.jpg","case_wing_zc_93_185_fl_033_004.jpg","case_wing_zc_93_185_fl_034_001.jpg","case_wing_zc_93_185_fl_034_002.jpg","case_wing_zc_93_185_fl_034_003.jpg","case_wing_zc_93_185_fl_035_001.jpg","case_wing_zc_93_185_fl_035_002.jpg","case_wing_zc_93_185_fl_035_003.jpg","case_wing_zc_93_185_fl_036_001.jpg","case_wing_zc_93_185_fl_036_002.jpg","case_wing_zc_93_185_fl_036_003.jpg","case_wing_zc_93_185_fl_036_004.jpg","case_wing_zc_93_185_fl_038_001.jpg","case_wing_zc_93_185_fl_038_002.jpg","case_wing_zc_93_185_fl_038_003.jpg","case_wing_zc_93_185_fl_038_004.jpg","case_wing_zc_93_185_fl_039_001.jpg","case_wing_zc_93_185_fl_039_002.jpg","case_wing_zc_93_185_fl_039_003.jpg","case_wing_zc_93_185_fl_040_001.jpg","case_wing_zc_93_185_fl_040_002.jpg","case_wing_zc_93_185_fl_040_003.jpg","case_wing_zc_93_185_fl_041_001.jpg","case_wing_zc_93_185_fl_041_002.jpg","case_wing_zc_93_185_fl_041_003.jpg","case_wing_zc_93_185_fl_042_001.jpg","case_wing_zc_93_185_fl_042_002.jpg","case_wing_zc_93_185_fl_042_003.jpg","case_wing_zc_93_185_fl_043_001.jpg","case_wing_zc_93_185_fl_043_002.jpg","case_wing_zc_93_185_fl_043_003.jpg","case_wing_zc_93_185_fl_044_001.jpg","case_wing_zc_93_185_fl_044_002.jpg","case_wing_zc_93_185_fl_044_003.jpg","case_wing_zc_93_185_fl_045_001.jpg","case_wing_zc_93_185_fl_045_002.jpg","case_wing_zc_93_185_fl_045_003.jpg","case_wing_zc_93_185_fl_046_001.jpg","case_wing_zc_93_185_fl_046_002.jpg","case_wing_zc_93_185_fl_047_001.jpg","case_wing_zc_93_185_fl_047_002.jpg","case_wing_zc_93_185_fl_047_003.jpg","case_wing_zc_93_185_fl_048_001.jpg","case_wing_zc_93_185_fl_048_002.jpg","case_wing_zc_93_185_fl_049_001.jpg","case_wing_zc_93_185_fl_049_002.jpg","case_wing_zc_93_185_fl_049_003.jpg","case_wing_zc_93_185_fl_049_004.jpg","case_wing_zc_93_185_fl_050_001.jpg","case_wing_zc_93_185_fl_050_002.jpg","case_wing_zc_93_185_fl_050_003.jpg","case_wing_zc_93_185_fl_051_001.jpg","case_wing_zc_93_185_fl_051_002.jpg","case_wing_zc_93_185_fl_051_003.jpg","case_wing_zc_93_185_fl_052_001.jpg","case_wing_zc_93_185_fl_052_002.jpg","case_wing_zc_93_185_fl_052_003.jpg","case_wing_zc_93_185_fl_053_001.jpg","case_wing_zc_93_185_fl_053_002.jpg","case_wing_zc_93_185_fl_053_003.jpg","case_wing_zc_93_185_fl_053_004.jpg","case_wing_zc_93_185_fl_054_001.jpg","case_wing_zc_93_185_fl_054_002.jpg","case_wing_zc_93_185_fl_054_003.jpg","case_wing_zc_93_185_fl_054_004.jpg","case_wing_zc_93_185_fl_055_001.jpg","case_wing_zc_93_185_fl_055_002.jpg","case_wing_zc_93_185_fl_055_003.jpg","case_wing_zc_93_185_fl_056_001.jpg","case_wing_zc_93_185_fl_056_002.jpg","case_wing_zc_93_185_fl_057_001.jpg","case_wing_zc_93_185_fl_057_002.jpg","case_wing_zc_93_185_fl_058_001.jpg"];

//_meta.xml vs. .jpg for the two series


/* xml sample
  <identifier>case_wing_zc_93_185_fl_001_001</identifier>
  <call_number>Case Wing oversize ZC 93 .185</call_number>
  <collection>newberry</collection>
  <contributor>The Newberry Library</contributor>
  <coverage>Italy</coverage>
  <date>1658</date>
  <description>Collection of 154 religious broadsides printed in Italy between 1611 and 1697. These broadsides were issued for various Catholic feast days and other religious occasions; the majority of items feature sonnets related to these topics. Many broadsides were commissioned by confraternities or trade guilds and most were dedicated to clerical or noble patrons of these organizations.</description>
  <language>ita</language>
  <link_to_catalog>https://i-share.carli.illinois.edu/nby/cgi-bin/Pwebrecon.cgi?DB=local&amp;v1=1&amp;BBRecID=308272</link_to_catalog>
  <mediatype>texts</mediatype>
  <physical_description>1 box (154 sheets) : illustrations, coats of arms ; 48 x 35 cm</physical_description>
  <publisher>Italy</publisher>
  <rights>All rights reserved by the Newberry Library. Permission to reproduce in any format must be requested in writing. Contact Digital Initiatives and Services, Newberry Library, 60 W. Walton St., Chicago, IL 60610. Phone: 312-255-3566. E-mail: rightsandrepro@newberry.org</rights>
  <title>Saint Andrew Apostle</title>
  <subject>Fasts and feasts</subject>
  <subject>Church history</subject>
  <subject>Christian saints</subject>
  <subject>Patronage, Ecclesiastical</subject>
  <subject>Guilds</subject>
  <subject>Holy Spirit</subject>
  */

$(document).ready(function() {
    $cards=$('#cards');
    //$('#prior').click=files[files.length-1]
    const elementData=[];

    files.forEach((file, i)=> {

    	var fileXml = './pdf-meta/'+file.replace('.jpg', '_meta.xml');

    	$.get( fileXml, function( data ) {
	    		const element = {};
	    		element.image = './pdf-jpg/'+file;
	    		element.title = data.getElementsByTagName('title')[0].textContent,
	    		element.call = data.getElementsByTagName('call_number')[0].textContent,
	    		element.coverage = data.getElementsByTagName('coverage')[0].textContent,
	    		element.date = data.getElementsByTagName('date')[0].textContent,
	    		element.description = data.getElementsByTagName('description')[0].textContent,
	    		element.physical = data.getElementsByTagName('physical_description')[0].textContent;

	    		element.subject = Array.prototype.slice.call(data.getElementsByTagName('subject')).map(node=>node.textContent);

	    		elementData.push(element);

	    		var card=`<div id="thumb${i}" class="col-xs-3" value="${i}"  >
	    								<div class="cardshadow" style="height:250px">
					            	<img src="./pdf-thumb/${file}" style="width: 100%" value="${i}" >
					            	<p class="small" style="margin-bottom: 0rem; line-height: 20px" value="${i}">${element.title.substring(0,16)+'...'}<br/>${element.date.trim()}</p>
					            </div>
        					</div>`

    //     const reloadImage = (element, i)=> {
    //     		$('#imglink').attr('href', element.image );
    //     		$('#mainImage').attr('src', element.image );
    //     		$('#mainImage').attr('value', i);
    //     		$('#mTitle').text(element.title);
    //     		$('#mCall').text(element.call);

    //     		$('#date').text(element.coverage +', '+element.date);
    //     		$('#physical').text(element.physical);
    //     		$('#desc').text(element.description);

    //     		$('#subjects').text(element.subject.join(' . '));
				// }

	        	$cards.append(card)

	        	$(`#thumb${i}`).click(e=>{
	        		var element = elementData[i];
	        		reloadImage(element, i);
	        	})
        	});




			});

    // $('#mainImage').change(()=>{

	   //      var less=(i-1>-1)? i-1: 0;
	   //      var more =(i+1<elementData.length-1)? i+1: elementData.length-1;

	   //      $('#prior').click(e=>{
		  //       		var element = elementData[less];
		  //       		reloadImage(element);
	   //      		});

	   //      $('#next').click(e=>{
		  //       		var element = elementData[more];
		  //       		reloadImage(element);
	   //      		});

    // });
const reloadImage = (element, i)=> {
        		$('#imglink').attr('href', element.image );
        		$('#mainImage').attr('src', element.image );
        		$('#mainImage').attr('value', i);
        		$('#mTitle').html(`<em>${element.title}</em>`);
        		$('#mCall').text(element.call);

        		$('#date').text(element.coverage +', '+element.date);
        		$('#physical').text(element.physical);
        		$('#desc').text(element.description);

        		$('#subjects').text(element.subject.join(' . '));

	        	var less=(i-1>-1)? i-1: 0;
		        var more =(i+1<files.length-1)? i+1: files.length-1;

		        console.log(elementData.length);

		        $('#prior').click(e=>{
			        		var element = elementData[less];
			        		reloadImage(element, less);
		        		});

		        $('#next').click(e=>{
			        		var element = elementData[more];
			        		reloadImage(element, more);
		        		});
					}

    });

